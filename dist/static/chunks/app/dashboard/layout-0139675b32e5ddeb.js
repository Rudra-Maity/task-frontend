(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{1476:(e,s,a)=>{Promise.resolve().then(a.bind(a,4632))},4632:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>B});var t=a(5155),r=a(2115),n=a(5695),l=a(3007),i=a(6874),c=a.n(i),o=a(183),d=a(7860),m=a(2098),h=a(3509),x=a(1362);function u(){let{setTheme:e}=(0,x.D)();return(0,t.jsxs)(d.rI,{children:[(0,t.jsx)(d.ty,{asChild:!0,children:(0,t.jsxs)(o.$,{variant:"ghost",size:"icon",children:[(0,t.jsx)(m.A,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),(0,t.jsx)(h.A,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,t.jsxs)(d.SQ,{align:"end",children:[(0,t.jsx)(d._2,{onClick:()=>e("light"),children:"Light"}),(0,t.jsx)(d._2,{onClick:()=>e("dark"),children:"Dark"}),(0,t.jsx)(d._2,{onClick:()=>e("system"),children:"System"})]})]})}var f=a(4783),j=a(4416),p=a(3861),g=a(8968),b=a(60),v=a(3464);function N(e){var s;let{mobileMenuOpen:a,setMobileMenuOpen:n}=e,{user:i,logout:m}=(0,l.A)(),[h,x]=(0,r.useState)([]),N=localStorage.getItem("token");return(0,r.useEffect)(()=>{!async function(){let e=await v.A.get("http://localhost:5000/api/notifications",{headers:{Authorization:"Bearer ".concat(N)}});console.log(e.data),x(e.data.notifications)}()},[]),(0,t.jsx)("header",{className:"sticky top-0 z-40 border-b bg-background",children:(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between px-4 md:px-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 md:gap-4",children:[console.log(a),(0,t.jsx)(o.$,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>{n(!a)},"aria-label":a?"Close menu":"Open menu",children:a?(0,t.jsx)(j.A,{size:20,onClick:()=>n(!1)}):(0,t.jsx)(f.A,{})}),(0,t.jsx)(c(),{href:"/dashboard",className:"flex items-center gap-2",children:(0,t.jsx)("span",{className:"text-xl font-bold",children:"TMS"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 md:gap-4",children:[(0,t.jsxs)(d.rI,{children:[(0,t.jsx)(d.ty,{asChild:!0,children:(0,t.jsxs)(o.$,{variant:"ghost",size:"icon",className:"relative",children:[(0,t.jsx)(p.A,{size:20}),(0,t.jsx)(b.E,{className:"absolute -right-1 -top-1 h-5 w-5 rounded-full p-0 text-xs",children:h.length})]})}),(0,t.jsxs)(d.SQ,{align:"end",className:"w-80",children:[(0,t.jsx)(d.lp,{children:"Notifications"}),(0,t.jsx)(d.mB,{}),(0,t.jsx)("div",{className:"max-h-80 overflow-y-auto",children:h.map((e,s)=>(0,t.jsxs)(d._2,{className:"flex cursor-pointer flex-col items-start p-3",children:[(0,t.jsx)("div",{className:"font-medium",children:e.message}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[function(e){let s=new Date(e),a=new Date-s;if(a<36e5){let e=Math.floor(a/36e5);return"".concat(e," hours ago")}if(a<2592e6){let e=Math.floor(a/864e5);return"".concat(e," days ago")}if(a<31536e6){let e=Math.floor(a/2592e6);return"".concat(e," months ago")}{let e=Math.floor(a/31536e6);return"".concat(e," years ago")}}(e.updatedAt)," "]})]},e._id))}),(0,t.jsx)(d.mB,{})]})]}),(0,t.jsx)(u,{}),(0,t.jsxs)(d.rI,{children:[(0,t.jsx)(d.ty,{asChild:!0,children:(0,t.jsx)(o.$,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,t.jsx)(g.eu,{className:"h-8 w-8",children:(0,t.jsx)(g.q5,{children:(s=null==i?void 0:i.name)?s.split(" ").map(e=>e[0]).join("").toUpperCase():"U"})})})}),(0,t.jsxs)(d.SQ,{align:"end",children:[(0,t.jsx)(d.lp,{children:"My Account"}),(0,t.jsx)(d.mB,{}),(0,t.jsx)(d._2,{children:(0,t.jsx)(c(),{href:"/dashboard/profile",className:"flex w-full items-center",children:"Profile"})}),(0,t.jsx)(d._2,{children:(0,t.jsx)(c(),{href:"/dashboard/settings",className:"flex w-full items-center",children:"Settings"})}),(0,t.jsx)(d.mB,{}),(0,t.jsx)(d._2,{onClick:m,className:"cursor-pointer text-destructive",children:"Log out"})]})]})]})]})})}var w=a(5384),k=a(3783),y=a(9145),A=a(7580),z=a(9074),C=a(4355),E=a(7434),M=a(381),_=a(2355),S=a(3052);let L=[{title:"Dashboard",href:"/dashboard",icon:k.A,roles:["admin","manager","user"]},{title:"My Tasks",href:"/dashboard/tasks",icon:y.A,roles:["admin","manager","user"]},{title:"Team Tasks",href:"/dashboard/team-tasks",icon:A.A,roles:["admin","manager"]},{title:"Calendar",href:"/dashboard/calendar",icon:z.A,roles:["admin","manager","user"]},{title:"Reports",href:"/dashboard/reports",icon:C.A,roles:["admin","manager"]},{title:"Projects",href:"/dashboard/projects",icon:E.A,roles:["admin","manager","user"]},{title:"User Management",href:"/dashboard/users",icon:A.A,roles:["admin"]},{title:"Settings",href:"/dashboard/settings",icon:M.A,roles:["admin","manager","user"]}];function O(e){let{mobileMenuOpen:s,setMobileMenuOpen:a}=e,i=(0,n.usePathname)(),{user:o}=(0,l.A)(),[d,m]=(0,r.useState)(!0),[h,x]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=()=>{let e=window.innerWidth<768;x(e),e&&d?m(!1):e||d||document.documentElement.classList.contains("sidebar-collapsed")||m(!0)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[d]),(0,r.useEffect)(()=>{h&&m(s)},[s,h]);let u=L.filter(e=>e.roles.includes((null==o?void 0:o.role)||"user"));return(0,t.jsxs)(t.Fragment,{children:[h&&s&&(0,t.jsx)("div",{className:"fixed inset-0 z-20 bg-black/50",onClick:()=>a(!1)}),(0,t.jsxs)("aside",{className:(0,w.cn)("h-screen flex flex-col border-r bg-background transition-all duration-300",h?"fixed inset-y-0 left-0 z-30":"sticky top-0 z-10",d?"w-64":"w-16",h&&!s&&"transform -translate-x-full"),children:[(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between px-4",children:[d&&(0,t.jsx)("h2",{className:"text-lg font-bold",children:"Navigation"}),!h&&(0,t.jsx)("button",{onClick:()=>{h?a(!s):(m(!d),d?document.documentElement.classList.add("sidebar-collapsed"):document.documentElement.classList.remove("sidebar-collapsed"))},className:"p-2 rounded-md hover:bg-accent","aria-label":d?"Collapse sidebar":"Expand sidebar",children:d?(0,t.jsx)(_.A,{size:20}):(0,t.jsx)(S.A,{size:20})})]}),(0,t.jsx)("nav",{className:"flex-1 space-y-1 px-2 py-4 overflow-y-auto",children:u.map(e=>(0,t.jsxs)(c(),{href:e.href,className:(0,w.cn)("flex items-center rounded-md px-3 py-2 text-sm font-medium transition-colors",i===e.href?"bg-primary text-primary-foreground":"text-foreground hover:bg-accent hover:text-accent-foreground",!d&&"justify-center"),onClick:()=>{h&&a(!1)},children:[(0,t.jsx)(e.icon,{className:(0,w.cn)("h-5 w-5 flex-shrink-0",d&&"mr-3")}),d&&(0,t.jsx)("span",{className:"truncate",children:e.title})]},e.href))})]})]})}function B(e){let{children:s}=e,{user:a,loading:i,isAuthenticated:c}=(0,l.A)(),[o,d]=(0,r.useState)(!1),m=(0,n.useRouter)();return((0,r.useEffect)(()=>{i||c||m.push("/login")},[i,c,m]),(0,r.useEffect)(()=>{let e=()=>{window.innerWidth>=768&&o&&d(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[o]),i)?(0,t.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,t.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):c?(0,t.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,t.jsx)(N,{mobileMenuOpen:o,setMobileMenuOpen:d}),(0,t.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,t.jsx)(O,{mobileMenuOpen:o,setMobileMenuOpen:d}),(0,t.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 ".concat(o?"md:ml-64":""),children:s})]})]}):null}},8968:(e,s,a)=>{"use strict";a.d(s,{eu:()=>l,q5:()=>i});var t=a(5155);a(2115);var r=a(4011),n=a(5384);function l(e){let{className:s,...a}=e;return(0,t.jsx)(r.bL,{"data-slot":"avatar",className:(0,n.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...a})}function i(e){let{className:s,...a}=e;return(0,t.jsx)(r.H4,{"data-slot":"avatar-fallback",className:(0,n.cn)("bg-muted flex size-full items-center justify-center rounded-full",s),...a})}}},e=>{var s=s=>e(e.s=s);e.O(0,[464,460,874,161,271,551,557,419,441,684,358],()=>s(1476)),_N_E=e.O()}]);