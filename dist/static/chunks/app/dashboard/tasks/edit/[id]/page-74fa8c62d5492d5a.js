(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[377],{1226:()=>{},2245:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var l=a(5155),t=a(2115);a(3784);var r=a(5196),i=a(9074),n=a(4416),c=a(4631),d=a(183),o=a(7881),h=a(6409),u=a(7075),x=a(4765),m=a(9182),j=a(3879),g=a(60),p=a(1965),N=a(7503),v=a(1731),y=a(3714),f=a(3464);function b(e){var s;let{params:a}=e,[b,w]=(0,t.useState)(!0),[k,T]=(0,t.useState)(!1),[E,C]=(0,t.useState)({title:"",description:"",status:"todo",priority:"medium",dueDate:null,assignedTo:"",recurringType:"none",recurringEndDate:null}),[D,S]=(0,t.useState)([]),[F,A]=(0,t.useState)(""),[J,_]=(0,t.useState)(!1),[P,B]=(0,t.useState)({}),[R,U]=(0,t.useState)(""),[V,W]=(0,t.useState)([]),$=localStorage.getItem("token"),{id:q}=t.use(a);(0,t.useEffect)(()=>{!async function(){let e=localStorage.getItem("token"),s=await f.A.get("http://localhost:5000/api/users",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});s.data?W(s.data.users):console.error("Failed to fetch users:",result.message)}()},[]),(0,t.useEffect)(()=>{!async function(){if(q)try{let e=await fetch("http://localhost:5000/api"+"/tasks/".concat(q),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat($)}});if(!e.ok)throw Error("Failed to fetch task");let s=await e.json();C(s.task),s.tags&&Array.isArray(s.tags)&&S(s.tags),_(!!s.isRecurring)}catch(e){B({fetch:e.message||"Failed to load task data"})}finally{w(!1)}}()},[q]);let I=e=>{let{name:s,value:a}=e.target;C(e=>({...e,[s]:a})),P[s]&&B(e=>{let a={...e};return delete a[s],a})},Z=(e,s)=>{C(a=>({...a,[e]:s})),P[e]&&B(s=>{let a={...s};return delete a[e],a})},L=(e,s)=>{C(a=>({...a,[e]:s}))},M=()=>{F.trim()&&!D.includes(F.trim())&&(S([...D,F.trim()]),A(""))},O=e=>{S(D.filter(s=>s!==e))},z=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"",G=()=>{let e={};return E.title.trim()||(e.title="Title is required"),J&&!E.recurringType&&(e.recurringType="Please select a recurrence pattern"),B(e),0===Object.keys(e).length},H=async e=>{if(e.preventDefault(),G()){T(!0),U("");try{let e={...E,tags:D,isRecurring:J};J||(e.recurringType="none",e.recurringEndDate=null);let s=await fetch("http://localhost:5000/api"+"/tasks/".concat(q),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat($)},body:JSON.stringify(e)}),a=await s.json();if(!s.ok)throw Error(a.message||"Failed to update task");U("Task updated successfully!"),setTimeout(()=>{},1500)}catch(e){B({submit:e.message})}finally{T(!1)}}};return b?(0,l.jsxs)(x.Zp,{className:"w-full max-w-3xl mx-auto",children:[(0,l.jsxs)(x.aR,{children:[(0,l.jsx)(y.E,{className:"h-8 w-48 mb-2"}),(0,l.jsx)(y.E,{className:"h-4 w-72"})]}),(0,l.jsxs)(x.Wu,{className:"space-y-6",children:[(0,l.jsx)(y.E,{className:"h-10 w-full"}),(0,l.jsx)(y.E,{className:"h-32 w-full"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsx)(y.E,{className:"h-10 w-full"}),(0,l.jsx)(y.E,{className:"h-10 w-full"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsx)(y.E,{className:"h-10 w-full"}),(0,l.jsx)(y.E,{className:"h-10 w-full"})]}),(0,l.jsx)(y.E,{className:"h-24 w-full"})]}),(0,l.jsx)(x.wL,{children:(0,l.jsxs)("div",{className:"flex justify-end w-full",children:[(0,l.jsx)(y.E,{className:"h-10 w-24 mr-2"}),(0,l.jsx)(y.E,{className:"h-10 w-24"})]})})]}):P.fetch?(0,l.jsxs)(x.Zp,{className:"w-full max-w-3xl mx-auto",children:[(0,l.jsx)(x.aR,{children:(0,l.jsx)(x.ZB,{className:"text-2xl font-bold",children:"Error"})}),(0,l.jsxs)(x.Wu,{children:[(0,l.jsx)(N.Fc,{className:"bg-red-50 border-red-200",children:(0,l.jsx)(N.TN,{className:"text-red-600",children:P.fetch})}),(0,l.jsx)("div",{className:"mt-6",children:(0,l.jsx)(d.$,{onClick:()=>router.push("/tasks"),children:"Back to Tasks"})})]})]}):(0,l.jsxs)(x.Zp,{className:"w-full max-w-3xl mx-auto",children:[(0,l.jsxs)(x.aR,{children:[(0,l.jsx)(x.ZB,{className:"text-2xl font-bold",children:"Edit Task"}),(0,l.jsx)(x.BT,{children:"Update task details"})]}),(0,l.jsxs)(x.Wu,{children:[R&&(0,l.jsxs)(N.Fc,{className:"mb-6 bg-green-50 border-green-200",children:[(0,l.jsx)(r.A,{className:"h-4 w-4 text-green-600"}),(0,l.jsx)(N.TN,{className:"text-green-600",children:R})]}),P.submit&&(0,l.jsx)(N.Fc,{className:"mb-6 bg-red-50 border-red-200",children:(0,l.jsx)(N.TN,{className:"text-red-600",children:P.submit})}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)(v.J,{htmlFor:"title",className:P.title?"text-red-500":"",children:["Title ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)(o.p,{id:"title",name:"title",value:E.title,onChange:I,placeholder:"Task title",className:P.title?"border-red-500":""}),P.title&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:P.title})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(v.J,{htmlFor:"description",children:"Description"}),(0,l.jsx)(h.T,{id:"description",name:"description",value:E.description||"",onChange:I,placeholder:"Describe the task",className:"min-h-32"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(v.J,{htmlFor:"status",children:"Status"}),(0,l.jsxs)(u.l6,{value:E.status,onValueChange:e=>Z("status",e),children:[(0,l.jsx)(u.bq,{children:(0,l.jsx)(u.yv,{placeholder:"Select status"})}),(0,l.jsxs)(u.gC,{children:[(0,l.jsx)(u.eb,{value:"todo",children:"To Do"}),(0,l.jsx)(u.eb,{value:"in-progress",children:"In Progress"}),(0,l.jsx)(u.eb,{value:"review",children:"Review"}),(0,l.jsx)(u.eb,{value:"completed",children:"Completed"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(v.J,{htmlFor:"priority",children:"Priority"}),(0,l.jsxs)(u.l6,{value:E.priority,onValueChange:e=>Z("priority",e),children:[(0,l.jsx)(u.bq,{children:(0,l.jsx)(u.yv,{placeholder:"Select priority"})}),(0,l.jsxs)(u.gC,{children:[(0,l.jsx)(u.eb,{value:"low",children:"Low"}),(0,l.jsx)(u.eb,{value:"medium",children:"Medium"}),(0,l.jsx)(u.eb,{value:"high",children:"High"}),(0,l.jsx)(u.eb,{value:"urgent",children:"Urgent"})]})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(v.J,{htmlFor:"dueDate",children:"Due Date"}),(0,l.jsxs)(m.AM,{children:[(0,l.jsx)(m.Wv,{asChild:!0,children:(0,l.jsxs)(d.$,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,l.jsx)(i.A,{className:"mr-2 h-4 w-4"}),E.dueDate?z(E.dueDate):(0,l.jsx)("span",{className:"text-gray-400",children:"Pick a date"})]})}),(0,l.jsx)(m.hl,{className:"w-auto p-0",children:(0,l.jsx)(p.V,{mode:"single",selected:E.dueDate,onSelect:e=>L("dueDate",e),initialFocus:!0})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(v.J,{htmlFor:"assignedTo",children:"Assigned To (User ID)"}),(0,l.jsxs)(u.l6,{value:(null==(s=E.assignedTo)?void 0:s._id)||"",onValueChange:e=>I({target:{name:"assignedTo",value:V.find(s=>s._id===e)}}),children:[(0,l.jsx)(u.bq,{id:"assignedTo",className:"w-full",children:(0,l.jsx)(u.yv,{placeholder:"Select a user"})}),(0,l.jsx)(u.gC,{children:V.map(e=>(0,l.jsx)(u.eb,{value:e._id,children:e.name},e._id))})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(v.J,{htmlFor:"tags",className:"block mb-2",children:"Tags"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:D.map(e=>(0,l.jsxs)(g.E,{variant:"secondary",className:"px-3 py-1",children:[e,(0,l.jsx)("button",{type:"button",onClick:()=>O(e),className:"ml-2 text-gray-500 hover:text-gray-700",children:(0,l.jsx)(n.A,{className:"h-3 w-3"})})]},e))}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(o.p,{id:"tagInput",value:F,onChange:e=>A(e.target.value),placeholder:"Add a tag",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),M())},className:"flex-1"}),(0,l.jsx)(d.$,{type:"button",variant:"outline",onClick:M,children:"Add"})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(j.d,{checked:J,onCheckedChange:_,id:"recurring-task"}),(0,l.jsx)(v.J,{htmlFor:"recurring-task",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Recurring Task"})]}),J&&(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 pl-6 border-l-2 border-gray-200",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(v.J,{htmlFor:"recurringType",className:P.recurringType?"text-red-500":"",children:"Recurrence Pattern"}),(0,l.jsxs)(u.l6,{value:E.recurringType||"none",onValueChange:e=>Z("recurringType",e),disabled:!J,children:[(0,l.jsx)(u.bq,{className:P.recurringType?"border-red-500":"",children:(0,l.jsx)(u.yv,{placeholder:"Select type"})}),(0,l.jsxs)(u.gC,{children:[(0,l.jsx)(u.eb,{value:"daily",children:"Daily"}),(0,l.jsx)(u.eb,{value:"weekly",children:"Weekly"}),(0,l.jsx)(u.eb,{value:"monthly",children:"Monthly"})]})]}),P.recurringType&&(0,l.jsx)("p",{className:"text-red-500 text-sm mt-1",children:P.recurringType})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)(v.J,{htmlFor:"recurringEndDate",children:"End Date"}),(0,l.jsxs)(m.AM,{children:[(0,l.jsx)(m.Wv,{asChild:!0,children:(0,l.jsxs)(d.$,{variant:"outline",className:"w-full justify-start text-left font-normal",disabled:!J,children:[(0,l.jsx)(i.A,{className:"mr-2 h-4 w-4"}),E.recurringEndDate?z(E.recurringEndDate):(0,l.jsx)("span",{className:"text-gray-400",children:"Pick a date"})]})}),(0,l.jsx)(m.hl,{className:"w-auto p-0",children:(0,l.jsx)(p.V,{mode:"single",selected:E.recurringEndDate,onSelect:e=>L("recurringEndDate",e),initialFocus:!0,disabled:!J})})]})]})]})]})]})]}),(0,l.jsxs)(x.wL,{className:"flex justify-end space-x-2",children:[(0,l.jsx)(d.$,{type:"button",variant:"outline",onClick:()=>router.push("/tasks"),children:"Cancel"}),(0,l.jsx)(d.$,{onClick:H,disabled:k,children:k?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):"Update Task"})]})]})}},3714:(e,s,a)=>{"use strict";a.d(s,{E:()=>r});var l=a(5155),t=a(5384);function r(e){let{className:s,...a}=e;return(0,l.jsx)("div",{"data-slot":"skeleton",className:(0,t.cn)("bg-accent animate-pulse rounded-md",s),...a})}},6528:(e,s,a)=>{Promise.resolve().then(a.bind(a,2245))}},e=>{var s=s=>e(e.s=s);e.O(0,[464,460,161,271,591,515,631,149,441,684,358],()=>s(6528)),_N_E=e.O()}]);